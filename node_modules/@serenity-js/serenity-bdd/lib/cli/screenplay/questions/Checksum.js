"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Checksum = void 0;
const core_1 = require("@serenity-js/core");
const crypto_1 = require("crypto");
const abilities_1 = require("../abilities");
/**
 * @package
 */
exports.Checksum = {
    of: (destination) => ({
        calculatedUsing: (hashingAlgorithm) => core_1.Question.about(`checksum of ${destination.value}`, actor => {
            const hash = (0, crypto_1.createHash)(hashingAlgorithm);
            const input = abilities_1.UseFileSystem.as(actor).createReadStream(destination);
            return new Promise((resolve, reject) => {
                input.on('data', data => hash.update(data));
                input.on('end', () => resolve(hash.digest('hex')));
                input.on('error', error => reject(error));
            });
        }),
    }),
};
//# sourceMappingURL=Checksum.js.map